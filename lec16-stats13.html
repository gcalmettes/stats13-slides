<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=10.0, user-scalable=no">

  <title>
    Lecture 16 - Stats 13
  </title>
  <link rel="stylesheet" href="assets/reveal.js-master/css/reveal.css" />
  <!-- beige, black, blood, league, moon, night, serif, simple, sky, solarized, white -->
  <link rel="stylesheet" href="assets/reveal.js-master/css/theme/black.css" id="theme"/>
  <!-- Theme used for syntax highlighting of code -->
  <link rel="stylesheet" href="assets/reveal.js-master/lib/css/zenburn.css">
  <!-- Custom css -->
  <link rel="stylesheet" href="assets/plugins/Font-Awesome-master/css/font-awesome.min.css" />
  <link rel="stylesheet" href="assets/css/custom-gc.css" />
  <link rel="stylesheet" href="assets/plugins/reveal.js-plugins-master/menu/menu.css">

</head>

<body>
  <div class="reveal">
    <!-- ====================== CUSTOM HEADERs & FOOTERs ====================== -->
  	<header id="myHeadRight" style="position: absolute; top: 0; right:0; z-index:500; font-size: small;">
  	</header>
  	<header id="myHeadLeft" style="position: absolute; top: 0; left:0; z-index:501; fon-size: small;">
  	</header>
  	<footer id="myFootRight" style="position: absolute; bottom:0; right:0; z-index:502; font-size: small;">
  	</footer>
  	<footer id="myFootLeft" style="position: absolute; bottom:0; left:0; z-index:503;font-size: small;">
  	</footer>
  	<!-- ====================== CUSTOM HEADERs & FOOTERs ====================== -->

<div class="slides">


<section class="title-slide" data-background='http://www.meioemensagem.com.br/wp-content/uploads/2017/01/MACHINE-LEARNING.jpg' data-state="alpha-04">
  <div class="content-box framed border-muted">
    <h2>Stats 13</h2>
    <h1 style="color: #FFFFFF">Lecture 16</h1>
  </div>
    <h3 style="color: #FFFFFF; text-align: center;">
      Machine Learning
    </h3>
    <div class="col-90">
      <p class="smaller push-right">Brooke Wenig + Guillaume Calmettes</p>
  </div>
</section>

<section>
  <h2>Monty Hall Problem</h2>
  <div class="row">
    <div class="col-100">
      <img src="assets/img/lec/ml-monty-hall-choices.png" width=100%>
    </div>
  </div>
</section>

<section>
  <h2>Monty Hall Problem</h2>
  <div class="row">
    <div class="col-100">
      <table>
        <tbody>
          <tr>
            <td colspan="3" class="bg-muted">What is really behind</td>
            <td colspan="2" class="bg-warning">What the result will be</td>
          </tr>
          <tr>
            <td class="bg-muted">Door 1</td>
            <td class="bg-muted">Door 2</td>
            <td class="bg-muted">Door 3</td>
            <td class="bg-warning">Staying at door 1</td>
            <td class="bg-warning">Switching to the door offered</td>
          </tr>
          <tr>
            <td><span class="info">Car</span></td>
            <td>Goat</td>
            <td style="border-right: 1px solid;">Goat</td>
            <td class="highlight-bckg-info">Wins car</td>
            <td>Wins goat</td>
          </tr>
          <tr>
            <td>Goat</td>
            <td><span class="info">Car</span></td>
            <td style="border-right: 1px solid;">Goat</td>
            <td>Wins goat</td>
            <td class="highlight-bckg-info">Wins car</td>
          </tr>
          <tr class="no-bottom">
            <td>Goat</td>
            <td>Goat</td>
            <td style="border-right: 1px solid;"><span class="info">Car</span></td>
            <td>Wins goat</td>
            <td class="highlight-bckg-info">Wins car</td>
          </tr>
          <tr class="no-bottom">
            <td height="10"></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr class="no-bottom">
            <td height="80"></td>
            <td></td>
            <td></td>
            <td><i class="fa fa-2x fa-arrow-circle-down info"></i></td>
            <td><i class="fa fa-2x fa-arrow-circle-down info"></i></td>
          </tr>
          <tr>
            <td colspan="3">Chance of getting the car:</td>
            <td><span class="framed border-info" style="padding-top: 0.3em; padding-bottom: 0.3em;">$1/3$</span></td>
            <td><span class="framed border-info" style="padding-top: 0.3em; padding-bottom: 0.3em;">$2/3$</span></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</section>

<section>
  <h2>What is Machine Learning?</h2>
  <div class="row">
    <div class="col-60">
      <p class="framed border-warning">
        Computers algorithms that <span class="warning">learn patterns</span> in your <span class="warning">data</span>.
      </p>
      <p>
        <span class="u em">Note:</span> <br>
        <i class="fa fa-arrow-circle-right danger"></i>
        Computers are <span class="danger">vulnerable to making mistakes</span>, like humans (will talk about this at the end)
      </p>
    </div>
    <div class="col-40">
      <img src="assets/img/lec/ml-machine-learning.svg" width=100%>
    </div>
  </div>  
</section>

<section>
  <h2>Decision Making</h2>
  <div class="row">
    <div class="col-100">
      <img src="assets/img/lec/ml-decision-tree-job-offer.svg" width=100%>
    </div>
  </div>
</section>

<section>
  <h2>Model this in Python?</h2>
  <div class="row">
    <div class="col-60">
      <pre style="width:100%">
        <code data-trim data-noescape>
          if salary < 50k:
            Decline offer
          else if salary > 50k and commute > 1 hr
            Decline offer
        </code>
      </pre>
    </div>
    <div class="col-40">
      <svg width="100%" viewBox="350 0 370 250" style="margin-top: 0;">
        <use xlink:href="assets/img/lec/ml-decision-tree-job-offer.svg#isolated"></use>
      </svg>
    </div>
  </div>
</section>

<section>
  <h2>Decision Tree</h2>
  <p>Really, it's an upside tree (leaves on bottom)</p>
  <p><span class="success">Leaf:</span> Terminal node (no child)</p>
  <p>Internal Node: Splits the predictor space</p>
  <!-- <img src="img/typesOfTrees.jpg" alt=""> -->
</section>

<section>
  <h2>Choosing a Restaurant</h2>
  <!-- <img src="assets/img/DecisionTreeTable.png" width=50%> -->
  <div class="row">
    <div class="col-100">
      <table style="font-size: 0.8em;">
        <tr class="no-bottom">
          <td rowspan="2" class="bg-warning" style="border-bottom: 1px solid !important; vertical-align: middle;">Examples</td>
          <td colspan="10" class="bg-info">Attributes</td>
          <td rowspan="2" class="bg-danger" style="border-bottom: 1px solid !important; vertical-align: middle;"> Target Wait</td>
        </tr>
        <tr>
          <td class="bg-info">Alt</td>
          <td class="bg-info">Bar</td>
          <td class="bg-info">Fri</td>
          <td class="bg-info">Hun</td>
          <td class="bg-info">Pat</td>
          <td class="bg-info">Price</td>
          <td class="bg-info">Rain</td>
          <td class="bg-info">Res</td>
          <td class="bg-info">Type</td>
          <td class="bg-info" width="100">Est</td>
        </tr>
        <tr>
          <td>$X_1$</td>
          <td>T</td>
          <td>F</td>
          <td>F</td>
          <td>T</td>
          <td>Some</td>
          <td>
            <i class="fa fa-dollar"></i>
            <i class="fa fa-dollar"></i>
            <i class="fa fa-dollar"></i>
          </td>
          <td>F</td>
          <td>T</td>
          <td>French</td>
          <td>0-10</td>
          <td>T</td>
        </tr>
        <tr>
          <td>$X_2$</td>
          <td>T</td>
          <td>F</td>
          <td>F</td>
          <td>T</td>
          <td>Full</td>
          <td>
            <i class="fa fa-dollar"></i>
          </td>
          <td>F</td>
          <td>F</td>
          <td>Thai</td>
          <td>30-60</td>
          <td>F</td>
        </tr>
        <tr>
          <td>$X_3$</td>
          <td>F</td>
          <td>T</td>
          <td>F</td>
          <td>F</td>
          <td>Some</td>
          <td>
            <i class="fa fa-dollar"></i>
          </td>
          <td>F</td>
          <td>F</td>
          <td>Burger</td>
          <td>0-10</td>
          <td>T</td>
        </tr>
        <tr>
          <td>$X_4$</td>
          <td>T</td>
          <td>F</td>
          <td>T</td>
          <td>T</td>
          <td>Full</td>
          <td>
            <i class="fa fa-dollar"></i>
          </td>
          <td>F</td>
          <td>F</td>
          <td>Thai</td>
          <td>10-30</td>
          <td>T</td>
        </tr>
        <tr>
          <td>$X_5$</td>
          <td>T</td>
          <td>F</td>
          <td>T</td>
          <td>F</td>
          <td>Full</td>
          <td>
            <i class="fa fa-dollar"></i>
            <i class="fa fa-dollar"></i>
            <i class="fa fa-dollar"></i>
          </td>
          <td>F</td>
          <td>T</td>
          <td>French</td>
          <td>>60</td>
          <td>F</td>
        </tr>
        <tr>
          <td>$X_6$</td>
          <td>F</td>
          <td>T</td>
          <td>F</td>
          <td>T</td>
          <td>Some</td>
          <td>
            <i class="fa fa-dollar"></i>
            <i class="fa fa-dollar"></i>
          </td>
          <td>T</td>
          <td>T</td>
          <td>Italian</td>
          <td>0-10</td>
          <td>T</td>
        </tr>
        <tr>
          <td>$X_7$</td>
          <td>F</td>
          <td>T</td>
          <td>F</td>
          <td>F</td>
          <td>None</td>
          <td>
            <i class="fa fa-dollar"></i>
          </td>
          <td>T</td>
          <td>F</td>
          <td>Burger</td>
          <td>0-10</td>
          <td>F</td>
        </tr>
        <tr>
          <td>$X_8$</td>
          <td>F</td>
          <td>F</td>
          <td>F</td>
          <td>T</td>
          <td>Some</td>
          <td>
            <i class="fa fa-dollar"></i>
            <i class="fa fa-dollar"></i>
          </td>
          <td>T</td>
          <td>T</td>
          <td>Thai</td>
          <td>0-10</td>
          <td>T</td>
        </tr>
        <tr>
          <td>$X_9$</td>
          <td>F</td>
          <td>T</td>
          <td>T</td>
          <td>F</td>
          <td>Full</td>
          <td>
            <i class="fa fa-dollar"></i>
          </td>
          <td>T</td>
          <td>F</td>
          <td>Burger</td>
          <td>>60</td>
          <td>F</td>
        </tr>
        <tr>
          <td>$X_{10}$</td>
          <td>T</td>
          <td>T</td>
          <td>T</td>
          <td>T</td>
          <td>Full</td>
          <td>
            <i class="fa fa-dollar"></i>
            <i class="fa fa-dollar"></i>
            <i class="fa fa-dollar"></i>
          </td>
          <td>F</td>
          <td>T</td>
          <td>Italian</td>
          <td>10-30</td>
          <td>F</td>
        </tr>
        <tr>
          <td>$X_{11}$</td>
          <td>F</td>
          <td>F</td>
          <td>F</td>
          <td>F</td>
          <td>None</td>
          <td>
            <i class="fa fa-dollar"></i>
          </td>
          <td>F</td>
          <td>F</td>
          <td>Thai</td>
          <td>0-10</td>
          <td>F</td>
        </tr>
        <tr>
          <td>$X_{12}$</td>
          <td>T</td>
          <td>T</td>
          <td>T</td>
          <td>T</td>
          <td>Full</td>
          <td>
            <i class="fa fa-dollar"></i>
          </td>
          <td>F</td>
          <td>F</td>
          <td>Burger</td>
          <td>30-60</td>
          <td>T</td>
        </tr>
      </table>
    </div>
  </div>
</section>

<section>
  <h2>Which attribute to split?</h2>
  <div class="row">
    <div class="col-100">
      <img src="assets/img/lec/ml-attribute-to-split.svg" width=100%>
    </div>
  </div>
  <p class="framed border-danger">Patrons is a better choice because it gives more <span class="danger">information</span> about the classification</p>
</section>

<section>
  <h2 style="text-align: center">Goal: Minimize Entropy</h2>
  <p style="text-align: center">$H[X] = -\sum_{k=1}^K P(X = a_{k})*log(P(X = a_{k}))$</p>
  <img src="assets/img/Entropy.png" style="height:400px">
</section>

<section>
  <h2>Depth</h2>
  <!-- <img src="img/decision-tree-1.png" style="border:none; box-shadow: 0 0 0px; height:200px"> -->
  <!-- <img src="img/decision-tree-2.png" style="border:none; box-shadow: 0 0 0px; height:400px"> -->
  <div class="row">
    <div class="col-50">
      <ul>
        <br>
        <li><span>Depth</span>: Longest path from root to a leaf node</li>
        <br>
        <li>If too deep, can overfit</li>
        <li>If too shallow, underfits</li>
      </ul>
    </div>
    <div class="col-50">
      <img src="assets/img/lec/ml-deep-decision-tree.svg" width=100%>
    </div>
  </div>
  
  <!-- <p class="fragment">Q: Best way to determine optimal depth?</p> -->
</section>

<section>
  <h2 style="padding-bottom:0px">Create trees</h2>
  <p class="framed border-info">Grow tree until stopping criteria reached (max depth, minimum information gain, etc.)</p>
  <!-- <div class="fragment"> -->
  <p class="framed border-success">Greedy, recursive partitioning</p>
  <img src="assets/img/SplitSpace.png" height=300px>
  <!-- </div> -->
</section>


<section>
  <h2>Comparison</h2>
  <div class="row">
    <div class="col-50">
      <p class="sided border-warning">
        <span class="warning">Pros</span>
      </p>
      <div style="text-align: left">
      <ul>
        <li>Interpretable</li>
        <li>Simple</li>
        <!-- <li>Flexible (different data types)</li> -->
      </ul>
      </div>
    </div>
    <div class="col-50">
      <p class="sided border-info">
      <span class="info">Cons</span>
      </p>
      <div style="text-align: left">
      <ul>
        <li>Poor accuracy</li>
        <li>High variance (if change training data a little, tree structure changes drastically)</li>
      </ul>
      </div>
    </div>
  </div>
</section>

<section>
  <h2 style="text-align: center">Bias vs Variance</h2>
  <img src="assets/img/bullseye.png" height=550px>
</section>

<!-- <section>
  <h2>Bias-Variance Tradeoff</h2>
  <p class="framed border-success">$Error = Variance + Bias^2 + noise$</p>
  <img src="assets/img/BiasVarianceTradeoff.png" height=50%>
</section>

<section>
  <h2>Bias-Variance Trade-off</h2>
  <p class="framed border-success">$Error = Variance + Bias^2 + noise$</p>

  <ul>
    <li>Reduce bias: Build more complex models</li>
    <li>Reduce variance: Use a lot of data or simple model</li>
    <li>How to reduce the error caused by noise?</li>
  </ul>
</section> -->

<section>
  <h2>Bagging</h2>
  <img src="assets/img/decision-tree-3.png" style="border:none; box-shadow: 0 0 0px; height:200px">
  <p>Averaging a set of observations reduces variance</p>
  <!-- <p>Set of n independent observations, $Z_{1}$, ..., $Z_{n}$, each with variance $\sigma^2$, then the variance of the mean $\bar{Z}$ of the observations is $\sigma^2/n$</p> -->
  <p>But we only have one training set... or do we?</p>
</section>

<section>
  <h2>Bootstrap</h2>
  <div class="row">
  <div class="col-50">
    <p>Simulate new datasets:</p>
    <ul>
      <li>Take samples (with replacement) from original training set</li>
      <li>Repeat n times</li>
    </ul>
  </div>
  <div class="col-50">
    <img src="assets/img/DeckCards2.png" alt="">
  </div>
  </div>
</section>

<section>
  <h3>The 632 rule</h3>
  <p>
    Sample has $n$ elements.
  </p>
  <div class="row framed border-info" style="padding-bottom: 10px">
    <div class="col-50">
      <p>
        Probability of getting picked:
      </p>
      <div>
        $\frac{1}{n}$
      </div>
    </div>
    <div class="col-50">
      <p>
        Probability of not getting picked:
      </p>
      <div>
         $1-\frac{1}{n}$
      </div>
    </div>
  </div>

  <p class="fragment">
    Sample $n$ elements with replacement, probability of not getting picked in the sample: $(1-\frac{1}{n})^n$
  </p>
  <p class="fragment">
    As ${n\to\infty}$, approaches $\frac{1}{e}\approx.368$
  </p>
  <p class="fragment">
    Thus, <span class="info">.632</span> of the data points in your original sample show up in the Bootstrap sample (the other .368 are duplicates)
  </p>
</section>

<section data-transition="fade" id="bootstrap-brooke">
  <h3>Bootstrap samples</h3>
  <div class="row" style="margin-top: 0;">
    <div class="col-40">
      <div class="placeholder"></div>
      <p style="margin-top: -4%; font-size: 0.5em;">
        <span class="u em">Each bootstrap sample:</span> <br>
        n=100, drawing WITH replacement <br>
        from original sample
      </p>
    </div>
    <div class="col-60">
      <label class="big" style="display: inline-block; width: 100%; text-align: center; font-family: sans-serif;">
        proportion: <span class="info" id="proportion">0</span>
      </label>
    </div>
  </div>
  <div class="fragment"></div>
  <div class="fragment"></div>
  <div class="fragment"></div>
</section>

<section>
  <h2>Bagging</h2>
  
  <ul>
    <li>Train a tree on each bootstrap sample, and average their predictions (Bootstrap Aggregating)</li>
    <li>Can grow deep trees!</li>
  </ul>
</section>

<section>
  <h2>Random Forests</h2>
  <div style="text-align: left">
  <ul>
    <li>Like bagging, but <span class="warning">removes correlation</span> among trees</li>
    <li>At each split, considers only a subset of predictors</li>
  </ul>
  </div>
</section>

<section>
  <h2 style="text-align: center">Random Forests</h2>
  <img src="assets/img/RandomForest.png" height=70%>
</section>

<section class="title-slide">
  <h2 style="text-align: center">The Dangers of Machine Learning</h2>
</section>

<section>
  <h2>Let's build a classifier</h2>
    <div class="row">
      <div class="col-50">
      <img src="assets/img/Aussie.jpg" style="height:300px">
    </div>
    <div class="col-50">
      <img src="assets/img/Cat.jpg" style="height:300px">
    </div>
    </div>
</section>

<section>
  <h2 style="text-align: center">What did the computer learn?</h2>
  <div class="fragment">
  <img src="assets/img/grass.jpg" style="height:300px">
  <h4 style="text-align: center"><span class="success">A grass classifier!</span></h4>
  </div>
</section>

<section>
    <div class="row">
      <div class="col-50" style="text-align: left">
      <h2>Overfitting</h2>
      <ul>
        <li>Superstition is overfitting to your training data</li>
        <br>
      </ul>
      <img src="assets/img/Superstition.jpg" height=310px>
    </div>
    <div class="col-50 fragment" style="text-align: left">
    <h2>Underfitting</h2>
      <ul>
        <li>Failing to learn from your mistakes = underfitting </li>
        <br>
      </ul>
      <img src="assets/img/UnderfittingBart.jpg" height=310px>
    </div>
  </div>
</section>

<section class="title-slide">
  <h1>Conclusion</h1>
</section>

<section>
  <h2>Sexiest job of the 21st century?</h2>
  <p class="quoted fragment">I keep saying the sexy job in the next ten years will be statisticians. People think I’m joking, but who would’ve guessed that computer engineers would’ve been the sexy job of the 1990s?</p> 
  <p class="fragment">-Google’s Chief Economist Hal Varian (2009)</p>
</section>

<section>
  <h2>Data Scientist vs. Statistician? </h2>
  <p class="quoted">
    A data scientist is a statistician that lives in San Francisco<br><br>
    Data science is statistics on a Mac<br><br>
    A data scientist is someone who is better at statistics than any software engineer and better at software engineering than any statistician</p>
  <p>Plus, they are paid more. Mean salary: 120,000 and Median salary: 126,000</p>
  <p class="fragment">Right or left skewed?</p>
</section>

<section>
  <h2>Plans after graduation?</h2>
  <p>Grad school? <a href="http://www.chemistry.ucla.edu/undergraduate-faq#7941">Departmental Scholars</a></p>
  <p>Industry? Check out data science bootcamps!</p>
</section>

<section class="title-slide">
  <h1 style="text-align: center">Thanks for the quarter!</h1>
</section>


<!-- THE END -->




<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - -->
<!-- - - - - - -    JAVASCRIP LOADING  - - - - - - - - - -->
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - -->


  <!-- Reveal -->
  <script src="assets/reveal.js-master/lib/js/head.min.js"></script>
  <script src="assets/reveal.js-master/js/reveal.js"></script>
    <!-- Reveal initialization file, including custom event listeners-->
  <script src="assets/js/Reveal-init-gc.js"></script>

  <script src="assets/js/jquery.js"></script>

  <!-- Looney slide -->
  <!-- <script src="assets/looney-slide/looney-reveal.js"></script> -->

  <!-- Google spreadsheet to javascript -->
  <!-- <script src='https://cdnjs.cloudflare.com/ajax/libs/tabletop.js/1.5.1/tabletop.min.js'></script> -->

  <!-- D3 -->
  <script src="assets/js/d3.v4.min.js"></script>
  <script src="assets/js/d3-selection-multi.v0.4.min.js"></script>

    <!-- D3 in REVEAL -->
  <script src="assets/js/d3-in-reveal.js"></script>
    <!-- The D3 config & animations -->
    <script src="assets/d3-anim/js-graphs/d3-in-reveal-config.js"></script>
    <script src="assets/d3-anim/js-graphs/bootstrap-brooke.js"></script>
    <!-- <script src="assets/d3-anim/js-graphs/sampling-distribution.js"></script>
    <script src="assets/d3-anim/js-graphs/live-sampling-words.js"></script>
    <script src="assets/d3-anim/js-graphs/sampling-frame.js"></script>
    <script src="assets/d3-anim/js-graphs/sample_table.js"></script>
    <!-- <script src="assets/d3-anim/js-graphs/shuffling.js"></script> -->
    <!-- <script src="assets/d3-anim/js-graphs/linear-regression.js"></script> -->
    <!-- <script src="assets/d3-anim/js-graphs/live-regression.js"></script> -->
    

</body>
</html>
